# Render Blueprint Configuration
# This file tells Render how to deploy the backend service
# Place this in the repo root or backend folder

services:
  - type: web
    name: bankwise-api
    runtime: docker
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    
    # Health check endpoint
    healthCheckPath: /actuator/health
    
    # Environment variables (set in Render dashboard for secrets)
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      - key: SERVER_PORT
        value: "8080"
      - key: JAVA_OPTS
        value: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
      # Database URL - set in Render dashboard (from Neon)
      - key: DATABASE_URL
        sync: false  # Must be set manually in dashboard
      - key: SPRING_DATASOURCE_URL
        sync: false
      - key: SPRING_DATASOURCE_USERNAME
        sync: false
      - key: SPRING_DATASOURCE_PASSWORD
        sync: false
      # JWT Secret - set in Render dashboard
      - key: JWT_SECRET
        sync: false
      # CORS origins
      - key: CORS_ALLOWED_ORIGINS
        value: "https://bankwise.netlify.app,https://*.netlify.app"
    
    # Auto-deploy on image push
    autoDeploy: true
    
    # Region (choose closest to your users)
    region: oregon  # or singapore, frankfurt, etc.
    
    # Plan
    plan: free  # or starter, standard for production
